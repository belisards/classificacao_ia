---
title: "Classifica√ß√£o de texto/imagens com IA de c√≥digo aberto"
subtitle: "ABRAJI/2025"
author: "Adriano Belisario"
format:
  revealjs:
    theme: solarized
    slide-number: true
    chalkboard: true
    preview-links: auto
---

# Apresenta√ß√£o

Desde 2012, atuo com comunica√ß√£o baseada em dados, j√° tendo colaborado com diversas organiza√ß√µes nacionais e internacionais.

[üìß adriano@belisario.website](adriano@belisario.website)

[üåê belisario.website](https://belisario.website/){.external target="_blank"}

[üñ•Ô∏è github.com/belisards/classificacao_ia](https://github.com/belisards/classificacao_ia){.external target="_blank"}

***

# Projetos

Nos √∫ltimos anos, desenvolvi modelos de classifica√ß√£o para resolver problemas reais em organiza√ß√µes como...

::: {.incremental}
- Oxford Internet Institute/Fogo Cruzado
- NetLab/UFRJ
- AzMina
- Bellingcat
:::

***

# Roteiro

::: {.incremental}
- Por que c√≥digo-aberto?
- No√ß√µes fundamentais sobre modelos de IA;
- Solu√ß√µes e exemplos em Python para classifica√ß√£o de textos;
- Classifica√ß√£o de imagens com o Smart Image Sorter;
:::

***

# IA & c√≥digo aberto

Garante liberdades para usar, estudar, modificar e compartilhar tecnologias.

[Defini√ß√£o da OSI](https://opensource.org/ai/open-source-ai-definition){.external target="_blank"} requer n√£o s√≥ acesso ao c√≥digo-fonte, mas tamb√©m dados de treinamento (ou descri√ß√£o completa) e pesos do modelo.

***

## Duas vis√µes

::: {.incremental}

::: {.columns}

::: {.column width="50%"}
**O que nos vendem...**

- Grandes

- Propriet√°rios

- Conhecimento gen√©rico

- Servi√ßos

- Na "nuvem"

- Solu√ß√µes tamanho "√∫nico"

:::

::: {.column width="50%"}
**O que (tamb√©m) queremos...**

- Pequenos

- C√≥digo-aberto

- Conhecimento espec√≠fico

- Ferramentas

- Auto-hospedados

- Solu√ß√µes customizadas
:::

:::

:::

***

# No√ß√µes fundamentais

*Dado uma informa√ß√£o de entrada (um input como texto ou imagem) determinar categorias/classes pr√©-estabelecida.*

‚ö†Ô∏è Classifica√ß√£o de textos ‚â† modelagem de t√≥picos

üí° Classifica√ß√£o pode ser enquadrada como uma tarefa de gera√ß√£o de texto (IA generativa) 


***

## Classifica√ß√£o de texto ontem e hoje

**NLP √† moda antiga**

::: {.incremental}
- Muito pr√©-processamento do texto de entrada (stemming, lematiza√ß√£o, etc).

- Representa√ß√£o das palavras com vetores esparsos via m√©todos "bag of words" baseados nas frequ√™ncias de palavras (exemplo: TF-IDF).

- Treina um modelo espec√≠fico do zero com exemplos pr√≥prios.

- Computacionalmente barato, ainda √© usado at√© hoje em determinadas situa√ß√µes.
:::

***

# Bag of words

![](imgs/basicbow.png)

***

**Abordagem atual/p√≥s-Transformers**

::: {.incremental}
- Pr√©-processamento inexistente ou m√≠nimo (ex: remo√ß√£o ou transcri√ß√£o de emojis)

- Representa√ß√µes com vetores densos (embeddings)

- Uso de redes neurais e modelos pr√©-treinados gen√©ricos (grandes modelos de linguagem, LLMs).

- Pr√©-treinamento (basicamente um auto completar) e treino (RLHF, instruction learning, etc)

- Computacionalmente intensivo
:::

***

## Tokens

[Tokens](https://huggingface.co/spaces/Xenova/the-tokenizer-playground){.external target="_blank"} s√£o as unidades m√≠nimas usadas para representar texto.

√â usado para calcular o custo de servi√ßos via API.

***

## Embeddings

Cada token √© representado por [embeddings](https://projector.tensorflow.org/){.external target="_blank"}, sequ√™ncias num√©ricas que refletem caracter√≠sticas sem√¢nticas. O resultado √© que elementos numericamente pr√≥ximos t√™m sem√¢ntica semelhante.

A representa√ß√£o final do input √© constru√≠da a partir das rela√ß√µes que os embeddings utilizados estabelecem entre si.

[üîó WSJ sobre tweets do Musk](https://www.wsj.com/tech/elon-musk-politics-trump-social-media-267d34c8){.external target="_blank"}

***

## Lingu√≠stica distribucional

> "O significado de uma palavra √© seu uso na linguagem." (Wittgenstein)

> ‚ÄúVoc√™ conhecer√° uma palavra pela companhia que ela mant√©m.‚Äù (J. R. Firth)

***

## Modelos Transformer (o T do ChatGPT)

*~~Love~~ Attention is all you need, 2017.*

![](imgs/attention.png)

Deu origem a duas grandes fam√≠lias de modelo: BERT e GPT.

***

::: {.incremental}

::: {.columns}

::: {.column width="50%"}

### BERT

- Entendimento da linguagem.
- Faz tarefas como classifica√ß√£o de texto e extra√ß√£o de entidades nomeadas.
- Facilmentre customiz√°veis, leves e exigem poucos recursos.
- Bidirecional.

:::

::: {.column width="50%"}
### GPT

- Gera√ß√£o de texto.
- Generalista e multi-prop√≥sito.
- Customiza√ß√£o mais complexa, pesados, custosos.
- Autoregressivo.

:::

:::

:::

***

## A √°rvore geneal√≥gica

![](imgs/llm_tree.png)

***

# BERT

![](imgs/bert_steps.png)

***

# GPTs

![](imgs/gpt_steps.png)

***

# Modos de usar

***

## Infer√™ncia zero-shot

Uso de um modelo pr√©-treinado sem o provimento de exemplos.

- [BART-LARGE](https://huggingface.co/facebook/bart-large-mnli)

- Modelos GPT com instru√ß√µes simples, input e classes apenas.

***

## Few-shot

Uso de um modelo pr√©-treinado provendo alguns exemplos "anotados". 

- [SetFit](https://github.com/huggingface/setfit)

- Modelos GPT: inclus√£o de exemplos no prompt. LLMs podem te ajudar a melhor o prompt.

***

## Ajuste fino (fine-tuning)

Altera o modelo para torn√°-lo mais especializado com base em um conjunto razo√°vel de dados anotados (anota√ß√£o correlacionada com desempenho).

- [Argilla.io](https://argilla.io/): √≥tima solu√ß√£o para anotar dados.

*** 

## Outros modos de usar

**RAGs:** usa uma cole√ß√£o de documentos para "embasar" as respostas do modelo.

**Knowledge distillation**: transferir conhecimento de um modelo grande para um modelo pequeno.

**Ensembling**: combinar predi√ß√µes de m√∫ltiplos modelos.

***

## Hugging Face

O Hugging Face est√° para os desenvolvedores de IA assim como o GitHub est√° para os desenvolvedores de software.

[https://huggingface.co/](https://huggingface.co/)

***

## Estrat√©gias para avalia√ß√£o

::: {.incremental}

- Defina uma linha base de avalia√ß√£o (trabalhos pr√©vios, ChatGPT, etc)

- Use estat√≠sticas de concord√¢ncias, como coeficiente Kappa, para avaliar o grau de concord√¢ncia de anota√ß√µes coletivas.

- Garanta a qualidade dos dados usados para avalia√ß√£o do modelo.

:::

***

## Avalia√ß√£o

::: {.incremental}

- **Recall:** entre os casos realmente positivos, quantos foram acertados. Ideal quando falsos negativos s√£o cr√≠ticos ou quando a classifica√ß√£o ser√° revisada/validada por pessoas.

- **Precis√£o:** entre os casos que o modelo classificou como positivos, quantos estavam corretos. Importante para priorizar que as classifica√ß√µes feitas sejam confi√°veis.

- **F1 score:** um tipo de m√©dia entre as anteriores, bom para mensurar a qualidade geral.

- [üîó Tutorial do Google](https://developers.google.com/machine-learning/crash-course/classification/accuracy-precision-recall?hl=pt-br){.external target="_blank"}

:::

***

## Modelos BERT em portugu√™s

- [BERTimbau](https://huggingface.co/belisards/bertimbau): "antigo" (2020), mas eficiente e ainda amplamente utilizado para fine-tuning de modelos em portugu√™s.

- [Albertina](https://huggingface.co/collections/PORTULAN/albertina-66a39cf7e2460605f3f1a9c2): modelos espec√≠ficos para portugu√™s de Portugal e do Brasil.

- [Congretimbau](https://huggingface.co/belisards/congretimbau): BERTimbau com pr√©-treinamento continuado para ementas de projetos de lei (C√¢mara e Senado).

***

## Outros modelos BERT

- [LegalBERT](https://huggingface.co/dominguesm/legal-bert-base-cased-ptbr): especializado em textos legais.

- [DeBERTinha](https://huggingface.co/sagui-nlp/debertinha-ptbr-xsmall): modelo leve, mas bate BERTimbau-Large (335M) em algumas tarefas.

- [ModernBERT](https://huggingface.co/answerdotai/ModernBERT-base): arquitetura mais moderna, por√©m treinado apenas em ingl√™s.

***

# M√£o na masssa

***

## Zero shot

[Zero shot com modelos BERT](https://colab.research.google.com/drive/1bfDI1gJlqjY_t61HesmHvHE7Yfi50AzS?usp=sharing)

[Zero shot com modelos generativos localmente]()

[Zero shot com modelos generativos via API]()

***

## Few shot

***

## Fine-tuning

**Fine-tuning**: [Classifica√ß√£o de risco aos direitos das mulheres com base em PLs](https://github.com/institutoazmina/ia-feminista-elas-no-congresso?tab=readme-ov-file#avalia%C3%A7%C3%A3o)

![](imgs/resultados_azmina.png)

***

## Fine-tuning

![](imgs/fogocruzado.png)

**Fogo Cruzado**: Detec√ß√£o de relatos de viol√™ncia armada em tempo real - [paper](https://arxiv.org/abs/2401.12989) e [reposit√≥rio no Github](https://github.com/belisards/gunviolence_ptbr/)


***

# Classifica√ß√£o de imagens

**Imagens e IA: formas de uso**

::: {.incremental}

- **Muita al√©m da gera√ß√£o de imagens:** responder perguntas baseado em imagens, segmentar imagens, detectar objetos ou pessoas, descrever imagens, geolocalizar imagem, etc.

- **E os v√≠deos?** A abordagem mais comum √© extra√ß√£o de frames, seja baseada em intervalos temporais ou de forma sem√¢ntica (*key frame extraction*).

:::

***

## Smart Image Sorter

::: {.incremental}
Classifica√ß√£o zero-shot de cole√ß√µes de imagens via interface gr√°fica ou linha de comando.

- [üîó Guia traduzido para portugu√™s](https://escoladedados.org/tutoriais/easy-ai-classificacao-imagens-tutorial/)

- [üîó GitHub](https://github.com/bellingcat/smart-image-sorter)

- [üîó Tutorial Bellingcat](https://www.bellingcat.com/resources/how-tos/2024/08/15/easy-ai-zero-shot-ai-image-classification-smart-image-sorter/)
:::
